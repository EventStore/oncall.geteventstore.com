define(["libs/knockout"],function(a){return a.components.register("support-agents-widget",{viewModel:{require:"components/SupportAgents/SupportAgents"},template:{require:"text!components/SupportAgents/SupportAgents.html"}}),a.components.register("calendar-widget",{viewModel:{require:"components/Calendar/Calendar"},template:{require:"text!components/Calendar/Calendar.html"}}),a.components.register("login-widget",{viewModel:{require:"components/Login/Login"},template:{require:"text!components/Login/Login.html"}}),function(){function b(a,b){var c=new XMLHttpRequest;c.open("PUT",window.Config.APIBaseUrl+"schedule/range/?DateStart="+a+"&DateEnd="+b,!0),c.setRequestHeader("Accept","application/json"),c.setRequestHeader("Authorization",userAccessKey),c.onload=function(){this.status>=200&&this.status<400?(d.errorMessages.push("Success: "+this.responseText),d.isSuccess(!0)):(d.errorMessages.push(this.responseText),d.isSuccess(!1))},c.onerror=function(){};var e={supportAgentName:d.selectedAgentName(),supportAgentId:d.selectedAgentId(),supportAgentColour:d.selectedAgentColour()};console.log(JSON.stringify(e)),c.send(JSON.stringify(e)),d.isLoading(!0)}function c(a,b){var c=new XMLHttpRequest;c.open("DELETE",window.Config.APIBaseUrl+"schedule/range/?DateStart="+a+"&DateEnd="+b,!0),c.setRequestHeader("Accept","application/json"),c.setRequestHeader("Authorization",userAccessKey),c.onload=function(){this.status>=200&&this.status<400?(d.errorMessages.push("Success: "+this.responseText),d.isSuccess(!0)):(d.errorMessages.push(this.responseText),d.isSuccess(!1))},c.onerror=function(){};var e={supportAgentId:d.selectedAgentId()};c.send(JSON.stringify(e)),d.isLoading(!0)}var d=this;d.selectedAgentId=a.observable(),d.isLoading=a.observable(!1),d.isLoggedIn=a.observable(!1),d.selectedAgentName=a.observable(),d.selectedAgentColour=a.observable(),d.selectedDates=a.observableArray([]),d.errorMessages=a.observableArray([]),d.showErrors=a.computed(function(){return d.errorMessages().length>0?!0:!1}),d.isSuccess=a.observable(!1),d.agentSelectionChanged=function(a,b,c){d.selectedAgentId(a),d.selectedAgentName(b),d.selectedAgentColour(c)},d.dateSelectionChanged=function(a){d.selectedDates(a)},d.canSave=a.computed(function(){return d.selectedDates().length>0}),d.logout=function(){userAccessKey="",d.isLoggedIn(!1)},d.canLogin=function(a){d.isLoggedIn(a)},d.addSelectedDates=function(){d.selectedDates.sort(function(a,b){return a.dateTime==b.dateTime?0:a.dateTime<b.dateTime?-1:1});var a=moment(d.selectedDates()[0].dateTime).date()+"-"+(moment(d.selectedDates()[0].dateTime).month()+1)+"-"+moment(d.selectedDates()[0].dateTime).year(),c=d.selectedDates().length,e=moment(d.selectedDates()[c-1].dateTime).date()+"-"+(moment(d.selectedDates()[c-1].dateTime).month()+1)+"-"+moment(d.selectedDates()[c-1].dateTime).year();b(a,e),d.selectedDates([]),setTimeout(function(){d.isLoading(!1)},500)},d.removeSelectedDates=function(){d.selectedDates.sort(function(a,b){return a.dateTime==b.dateTime?0:a.dateTime<b.dateTime?-1:1});var a=moment(d.selectedDates()[0].dateTime).date()+"-"+(moment(d.selectedDates()[0].dateTime).month()+1)+"-"+moment(d.selectedDates()[0].dateTime).year(),b=d.selectedDates().length,e=moment(d.selectedDates()[b-1].dateTime).date()+"-"+(moment(d.selectedDates()[b-1].dateTime).month()+1)+"-"+moment(d.selectedDates()[b-1].dateTime).year();c(a,e),d.selectedDates([]),setTimeout(function(){d.isLoading(!1)},500)}}});