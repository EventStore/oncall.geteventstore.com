define(["libs/knockout","./ContactMethods/ContactMethodEmail/ContactMethodEmail","./ContactMethods/ContactMethodPhone/ContactMethodPhone"],function(a,b,c){return a.components.register("email-editor",{template:{require:"text!components/SupportAgents/SupportAgentEditor/ContactMethods/ContactMethodEmail/ContactMethodEmail.html"}}),a.components.register("phone-editor",{template:{require:"text!components/SupportAgents/SupportAgentEditor/ContactMethods/ContactMethodPhone/ContactMethodPhone.html"}}),function(d){function e(a){var b=new XMLHttpRequest;b.open("GET",window.Config.APIBaseUrl+"agents/"+a,!0),b.setRequestHeader("Accept","application/json"),b.setRequestHeader("Authorization",userAccessKey),b.onload=function(){if(this.status>=200&&this.status<400){var a=JSON.parse(this.response);f.firstName(a.firstName),f.lastName(a.lastName),f.contactMethods(a.contactMethods),f.assignedColour(a.assignedColour),f.hidden(a.hidden)}else f.errorMessages.push(this.responseText)},b.onerror=function(){},b.send()}var f=this;if(f.isNew=a.observable(!0),f.currentId=a.observable(""),f.contactMethods=a.observableArray([]),f.firstName=a.observable(""),f.lastName=a.observable(""),f.assignedColour=a.observable(),f.hidden=a.observable(!1),f.errorMessages=a.observableArray([]),f.showErrors=a.computed(function(){return f.errorMessages().length>0?!0:!1}),console.log("Support agent editor created with params:",d),void 0!==d.id){f.isNew(!1),e(d.id),f.currentId(d.id);var g=document.getElementById("firstNameInput"),h=document.getElementById("lastNameInput"),i=document.getElementById("assignedColourInput");g.value=f.firstName,h.value=f.lastName,i.value=f.assignedColour}f.addEmail=function(){var a=new b;f.contactMethods.push(a)},f.addPhone=function(){var a=new c;a.type="Phone",f.contactMethods.push(a)},f.addSms=function(){var a=new c;a.type="Sms",f.contactMethods.push(a)},f.removeContactMethod=function(a){f.contactMethods.remove(a)},f.saveAgent=function(b){console.log(b);var c=new XMLHttpRequest;f.isNew()?(c.open("POST",window.Config.APIBaseUrl+"agents/",!0),c.setRequestHeader("Content-Type","application/json"),c.setRequestHeader("Authorization",userAccessKey)):(c.open("PATCH",window.Config.APIBaseUrl+"agents/"+f.currentId(),!0),c.setRequestHeader("Content-Type","application/json"),c.setRequestHeader("Authorization",userAccessKey)),c.onload=function(){this.status>=200&&this.status<400?b.returnToList():(f.errorMessages.push(this.responseText),console.log(this.responseText),console.log(this.response))},c.onerror=function(){},console.log(f.assignedColour());var d={contactMethods:a.toJSON(f.contactMethods),firstName:f.firstName(),lastName:f.lastName(),assignedColour:f.assignedColour()};c.send(JSON.stringify(d))},f.hideAgent=function(a){var b=new XMLHttpRequest;console.log("Setting up request."),b.open("PATCH",window.Config.APIBaseUrl+"agents/hide/"+f.currentId(),!0),b.setRequestHeader("Content-Type","application/json"),b.setRequestHeader("Authorization",userAccessKey),console.log("Let's Go"),b.onload=function(){this.status>=200&&this.status<400?a.returnToList():f.errorMessages.push(this.responseText)},b.onerror=function(){},b.send("")},f.showAgent=function(a){var b=new XMLHttpRequest;b.open("PATCH",window.Config.APIBaseUrl+"agents/show/"+f.currentId(),!0),b.setRequestHeader("Content-Type","application/json"),b.setRequestHeader("Authorization",userAccessKey),b.onload=function(){this.status>=200&&this.status<400?a.returnToList():f.errorMessages.push(this.responseText)},b.onerror=function(){},b.send("")}}});